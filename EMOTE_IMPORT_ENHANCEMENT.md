# è¡¨æƒ…å¯¼å…¥åŠŸèƒ½å¢å¼º

## ğŸ¯ åŠŸèƒ½è¯´æ˜

ä¸ºè¡¨æƒ…å¯¼å…¥åŠŸèƒ½æ·»åŠ äº†å¤šç§å¯¼å…¥é€‰é¡¹ï¼Œç°åœ¨æ”¯æŒä»ä¸åŒæ¥æºå¯¼å…¥è¡¨æƒ…ã€‚

## âœ¨ æ–°å¢åŠŸèƒ½

### ä¹‹å‰ï¼ˆä»…æ”¯æŒï¼‰
- âœ… ä» .zip æ–‡ä»¶å¯¼å…¥

### ç°åœ¨ï¼ˆæ”¯æŒ 3 ç§æ–¹å¼ï¼‰
1. âœ… ä» .zip æ–‡ä»¶å¯¼å…¥
2. âœ¨ **ä» .tar.gz æ–‡ä»¶å¯¼å…¥** (æ–°å¢)
3. âœ¨ **ä»æ–‡ä»¶å¯¼å…¥** (æ–°å¢) - ç›´æ¥é€‰æ‹©å¤šä¸ªå›¾ç‰‡æ–‡ä»¶

## ğŸ“ æ–‡ä»¶å‘½åè§„åˆ™

### æ”¯æŒçš„å›¾ç‰‡æ ¼å¼
- âœ… PNG (`.png`, `.PNG`)
- âœ… APNG (`.apng`, `.APNG`) - åŠ¨ç”» PNG
- âœ… GIF (`.gif`, `.GIF`) - åŠ¨å›¾
- âœ… AVIF (`.avif`, `.AVIF`) - æ–°ä¸€ä»£å›¾ç‰‡æ ¼å¼
- âœ… JPG/JPEG (`.jpg`, `.jpeg`, `.JPG`, `.JPEG`)
- âœ… WebP (`.webp`, `.WEBP`)

### å¿«æ·ç ç”Ÿæˆè§„åˆ™

æ–‡ä»¶åï¼ˆä¸å«æ‰©å±•åï¼‰è‡ªåŠ¨ä½œä¸ºè¡¨æƒ…å¿«æ·ç ï¼š

| æ–‡ä»¶å | è¡¨æƒ…å¿«æ·ç  | è¯´æ˜ |
|--------|-----------|------|
| `smile.png` | `:smile:` | åŸºæœ¬ä½¿ç”¨ |
| `ç¬‘è„¸.png` | `:ç¬‘è„¸:` | æ”¯æŒä¸­æ–‡ |
| `happy_face.gif` | `:happy_face:` | æ”¯æŒä¸‹åˆ’çº¿ |
| `very-happy.apng` | `:very-happy:` | æ”¯æŒè¿å­—ç¬¦ |
| `emoji 1.png` | `:emoji_1:` | ç©ºæ ¼æ›¿æ¢ä¸ºä¸‹åˆ’çº¿ |
| `my:emoji.png` | `:my_emoji:` | å†’å·æ›¿æ¢ä¸ºä¸‹åˆ’çº¿ |

### å­—ç¬¦å¤„ç†è§„åˆ™
- âœ… **ä¿ç•™**: å­—æ¯ã€æ•°å­—ã€ä¸­æ–‡ã€æ—¥æ–‡ã€éŸ©æ–‡ã€è¿å­—ç¬¦ã€ä¸‹åˆ’çº¿
- ğŸ”„ **æ›¿æ¢ä¸ºä¸‹åˆ’çº¿**: ç©ºæ ¼ã€å†’å· `:`ã€æ³¢æµªå· `~`
- âœ… **è‡ªåŠ¨ç§»é™¤æ‰©å±•å**: æ‰€æœ‰æ”¯æŒçš„å›¾ç‰‡æ ¼å¼æ‰©å±•å

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### æ–¹æ³• 1: ä» .zip æ–‡ä»¶å¯¼å…¥

1. **å‡†å¤‡ zip æ–‡ä»¶**
   ```bash
   # åˆ›å»ºä¸€ä¸ªåŒ…å«è¡¨æƒ…çš„ zip æ–‡ä»¶ï¼ˆæ”¯æŒæ··åˆæ ¼å¼ï¼‰
   mkdir emotes
   cp smile.png laugh.gif cry.jpg party.webp emotes/
   zip -r my-emotes.zip emotes/
   ```

2. **å¯¼å…¥**
   - è®¾ç½® â†’ èŠå¤© â†’ è¡¨æƒ…è®¾ç½®
   - ç‚¹å‡»å³ä¸Šè§’èœå• â‹®
   - é€‰æ‹© "ä» .zip æ–‡ä»¶å¯¼å…¥"
   - é€‰æ‹© `my-emotes.zip`
   - ç¡®è®¤è¡¨æƒ…å¿«æ·ç å¹¶å¯¼å…¥

### æ–¹æ³• 2: ä» .tar.gz æ–‡ä»¶å¯¼å…¥

1. **å‡†å¤‡ tar.gz æ–‡ä»¶**
   ```bash
   # åˆ›å»º tar.gz å‹ç¼©åŒ…ï¼ˆæ”¯æŒæ··åˆæ ¼å¼ï¼‰
   mkdir emotes
   # å¯ä»¥åŒ…å«å„ç§å›¾ç‰‡æ ¼å¼
   cp *.{png,jpg,gif,webp,avif} emotes/ 2>/dev/null
   tar -czf my-emotes.tar.gz emotes/
   ```

2. **å¯¼å…¥**
   - è®¾ç½® â†’ èŠå¤© â†’ è¡¨æƒ…è®¾ç½®
   - ç‚¹å‡»å³ä¸Šè§’èœå• â‹®
   - é€‰æ‹© "ä» .tar.gz æ–‡ä»¶å¯¼å…¥"
   - é€‰æ‹© `my-emotes.tar.gz`
   - ç¡®è®¤è¡¨æƒ…å¿«æ·ç å¹¶å¯¼å…¥

3. **æ”¯æŒçš„æ ¼å¼**
   - `.tar.gz` - gzip å‹ç¼©çš„ tar åŒ…
   - `.tgz` - tar.gz çš„ç®€å†™
   - `.tar` - çº¯ tar åŒ…ï¼ˆæ— å‹ç¼©ï¼‰

### æ–¹æ³• 3: ä»æ–‡ä»¶å¯¼å…¥ï¼ˆæœ€ç®€å•ï¼‰

1. **ç›´æ¥é€‰æ‹©å›¾ç‰‡æ–‡ä»¶**
   - æ— éœ€åˆ›å»ºå‹ç¼©åŒ…
   - ç›´æ¥é€‰æ‹©å¤šä¸ªå›¾ç‰‡æ–‡ä»¶

2. **å¯¼å…¥æ­¥éª¤**
   - è®¾ç½® â†’ èŠå¤© â†’ è¡¨æƒ…è®¾ç½®
   - ç‚¹å‡»å³ä¸Šè§’èœå• â‹®
   - é€‰æ‹© "ä»æ–‡ä»¶å¯¼å…¥"
   - **å¤šé€‰**æ‰€æœ‰è¦å¯¼å…¥çš„å›¾ç‰‡æ–‡ä»¶
   - ç¡®è®¤è¡¨æƒ…å¿«æ·ç å¹¶å¯¼å…¥

3. **é€‚ç”¨åœºæ™¯**
   - å°‘é‡è¡¨æƒ…ï¼ˆ1-20 ä¸ªï¼‰
   - ä¸æƒ³åˆ›å»ºå‹ç¼©åŒ…
   - å¿«é€Ÿæ·»åŠ è¡¨æƒ…

## ğŸ“‚ å®é™…ä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹ 1: å¯¼å…¥ä¸­æ–‡è¡¨æƒ…åŒ…

**æ–‡ä»¶ç»“æ„ï¼š**
```
è¡¨æƒ…åŒ…/
  â”œâ”€â”€ ç¬‘è„¸.png
  â”œâ”€â”€ å“­æ³£.gif
  â”œâ”€â”€ å¼€å¿ƒ.apng
  â””â”€â”€ æ„¤æ€’.png
```

**æ‰“åŒ…ï¼š**
```bash
tar -czf ä¸­æ–‡è¡¨æƒ….tar.gz è¡¨æƒ…åŒ…/
```

**å¯¼å…¥åè‡ªåŠ¨ç”Ÿæˆå¿«æ·ç ï¼š**
- `:ç¬‘è„¸:` â†’ ç¬‘è„¸.png
- `:å“­æ³£:` â†’ å“­æ³£.gif
- `:å¼€å¿ƒ:` â†’ å¼€å¿ƒ.apng
- `:æ„¤æ€’:` â†’ æ„¤æ€’.png

### ç¤ºä¾‹ 2: å¯¼å…¥åŠ¨ç”»è¡¨æƒ…

**æ–‡ä»¶ï¼š**
```
animations/
  â”œâ”€â”€ dancing.gif
  â”œâ”€â”€ jumping.apng
  â”œâ”€â”€ spinning.gif
  â””â”€â”€ waving.png
```

**æ‰“åŒ…ï¼š**
```bash
zip -r animations.zip animations/
```

**å¯¼å…¥åè‡ªåŠ¨ç”Ÿæˆå¿«æ·ç ï¼š**
- `:dancing:` â†’ dancing.gif
- `:jumping:` â†’ jumping.apng
- `:spinning:` â†’ spinning.gif
- `:waving:` â†’ waving.png

### ç¤ºä¾‹ 3: å¿«é€Ÿå¯¼å…¥å‡ ä¸ªå›¾ç‰‡

**æ–‡ä»¶ï¼š**
ç›´æ¥æœ‰ 3 ä¸ªå›¾ç‰‡æ–‡ä»¶åœ¨æ¡Œé¢ï¼š
- `smile.png`
- `love.png`
- `thumbs-up.png`

**æ­¥éª¤ï¼š**
1. é€‰æ‹© "ä»æ–‡ä»¶å¯¼å…¥"
2. Ctrl+ ç‚¹å‡»é€‰æ‹©è¿™ 3 ä¸ªæ–‡ä»¶
3. å¯¼å…¥

**å¯¼å…¥åï¼š**
- `:smile:` â†’ smile.png
- `:love:` â†’ love.png
- `:thumbs-up:` â†’ thumbs-up.png

## ğŸ”§ æŠ€æœ¯å®ç°ç»†èŠ‚

### ä¿®æ”¹çš„æ–‡ä»¶

```
lib/pages/settings_emotes/settings_emotes.dart
  âœ“ æ·»åŠ  importEmojiTarGz() æ–¹æ³•
  âœ“ æ·»åŠ  importEmojiFromFiles() æ–¹æ³•
  
lib/pages/settings_emotes/settings_emotes_view.dart
  âœ“ æ›´æ–°èœå•æšä¸¾ï¼šæ·»åŠ  importTarGz, importFiles
  âœ“ æ›´æ–°èœå•é¡¹æ˜¾ç¤º
  
lib/pages/settings_emotes/import_archive_dialog.dart
  âœ“ æ”¹è¿›æ–‡ä»¶åå¤„ç†é€»è¾‘
  âœ“ æ”¯æŒæ›´å¤šå›¾ç‰‡æ ¼å¼
  âœ“ æ”¯æŒ Unicode å­—ç¬¦ï¼ˆä¸­æ–‡ç­‰ï¼‰
  âœ“ æ›´æ–°è¾“å…¥éªŒè¯å™¨

lib/l10n/intl_en.arb
lib/l10n/intl_zh.arb
lib/l10n/intl_zh_Hant.arb
  âœ“ æ·»åŠ æ–°çš„ç¿»è¯‘æ–‡æœ¬
```

### æ ¸å¿ƒä»£ç æ”¹è¿›

#### 1. æ–‡ä»¶åå¤„ç†é€»è¾‘

**ä¿®æ”¹å‰ï¼š**
```dart
String get emoteNameFromPath {
  return split(RegExp(r'[/\\]'))
      .last
      .split('.')
      .first
      .toLowerCase()  // å¼ºåˆ¶å°å†™
      .replaceAll(RegExp(r'[^-\w]'), '_');  // åªæ”¯æŒ ASCII
}
```

**ä¿®æ”¹åï¼š**
```dart
String get emoteNameFromPath {
  var name = split(RegExp(r'[/\\]')).last;
  
  // æ”¯æŒå¤šç§å›¾ç‰‡æ ¼å¼
  final supportedExtensions = [
    '.png', '.apng', '.gif', '.avif',
    '.jpg', '.jpeg', '.webp',
    '.PNG', '.APNG', '.GIF', '.AVIF',
    '.JPG', '.JPEG', '.WEBP',
  ];
  
  for (final ext in supportedExtensions) {
    if (name.endsWith(ext)) {
      name = name.substring(0, name.length - ext.length);
      break;
    }
  }
  
  // æ”¯æŒ Unicodeï¼Œåªæ›¿æ¢ç‰¹æ®Šåˆ†éš”ç¬¦
  return name.replaceAll(RegExp(r'[\s:~]'), '_');
}
```

#### 2. tar.gz å¯¼å…¥å®ç°

```dart
Future<void> importEmojiTarGz() async {
  final result = await showFutureLoadingDialog<Archive?>(
    context: context,
    future: () async {
      final result = await selectFiles(context, type: FileSelectorType.any);
      if (result.isEmpty) return null;
      
      // éªŒè¯æ–‡ä»¶æ‰©å±•å
      if (!result.first.name.endsWith('.tar') &&
          !result.first.name.endsWith('.tar.gz') &&
          !result.first.name.endsWith('.tgz')) {
        throw Exception('Please select a .tar.gz or .tgz file');
      }
      
      final bytes = await result.first.readAsBytes();
      Archive archive;
      
      // æ ¹æ®æ–‡ä»¶ç±»å‹è§£ç 
      if (result.first.name.endsWith('.gz') ||
          result.first.name.endsWith('.tgz')) {
        final gzipDecoder = GZipDecoder();
        final tarBytes = gzipDecoder.decodeBytes(bytes);
        archive = TarDecoder().decodeBytes(tarBytes);
      } else {
        archive = TarDecoder().decodeStream(InputMemoryStream(bytes));
      }
      
      return archive;
    },
  );
  
  // ... æ˜¾ç¤ºå¯¼å…¥å¯¹è¯æ¡†
}
```

#### 3. ä»æ–‡ä»¶å¯¼å…¥å®ç°

```dart
Future<void> importEmojiFromFiles() async {
  final result = await showFutureLoadingDialog<Archive?>(
    context: context,
    future: () async {
      // ç›´æ¥é€‰æ‹©å¤šä¸ªå›¾ç‰‡æ–‡ä»¶
      final result = await selectFiles(
        context,
        type: FileSelectorType.images,
        allowMultiple: true,
      );
      
      if (result.isEmpty) return null;
      
      // åˆ›å»ºå†…å­˜ä¸­çš„ Archive
      final archive = Archive();
      
      for (final file in result) {
        final bytes = await file.readAsBytes();
        final archiveFile = ArchiveFile(
          file.name,
          bytes.length,
          bytes,
        );
        archive.addFile(archiveFile);
      }
      
      return archive;
    },
  );
  
  // ... æ˜¾ç¤ºå¯¼å…¥å¯¹è¯æ¡†
}
```

## ğŸ¨ UI æ”¹è¿›

### èœå•ç»“æ„

**ä¹‹å‰ï¼š**
```
â‹® èœå•
â”œâ”€â”€ ä» .zip æ–‡ä»¶å¯¼å…¥
â””â”€â”€ å¯¼å‡ºè¡¨æƒ…åŒ…
```

**ç°åœ¨ï¼š**
```
â‹® èœå•
â”œâ”€â”€ ä» .zip æ–‡ä»¶å¯¼å…¥
â”œâ”€â”€ ä» .tar.gz æ–‡ä»¶å¯¼å…¥     â† æ–°å¢
â”œâ”€â”€ ä»æ–‡ä»¶å¯¼å…¥              â† æ–°å¢
â””â”€â”€ å¯¼å‡ºè¡¨æƒ…åŒ…
```

### å¯¼å…¥é¢„è§ˆç•Œé¢æ”¹è¿›

- âœ… æ”¯æŒ Unicode å­—ç¬¦è¾“å…¥
- âœ… å®æ—¶é¢„è§ˆå›¾ç‰‡
- âœ… å¯ç¼–è¾‘è¡¨æƒ…å¿«æ·ç 
- âœ… æ”¯æŒåˆ é™¤ä¸éœ€è¦çš„è¡¨æƒ…
- âœ… æ˜¾ç¤ºè¿›åº¦æ¡

## ğŸŒ å›½é™…åŒ–æ”¯æŒ

| è¯­è¨€ | ä» .zip å¯¼å…¥ | ä» .tar.gz å¯¼å…¥ | ä»æ–‡ä»¶å¯¼å…¥ |
|------|-------------|----------------|-----------|
| è‹±æ–‡ | Import from .zip file | Import from .tar.gz file | Import from files |
| ç®€ä½“ä¸­æ–‡ | ä» .zip æ–‡ä»¶å¯¼å…¥ | ä» .tar.gz æ–‡ä»¶å¯¼å…¥ | ä»æ–‡ä»¶å¯¼å…¥ |
| ç¹ä½“ä¸­æ–‡ | å¾ .zip æª”æ¡ˆåŒ¯å…¥ | å¾ .tar.gz æª”æ¡ˆåŒ¯å…¥ | å¾æª”æ¡ˆåŒ¯å…¥ |

## âœ… å®ŒæˆçŠ¶æ€

- âœ… æ”¯æŒ .zip æ–‡ä»¶å¯¼å…¥ï¼ˆåŸæœ‰ï¼‰
- âœ… æ”¯æŒ .tar.gz / .tgz / .tar æ–‡ä»¶å¯¼å…¥ï¼ˆæ–°å¢ï¼‰
- âœ… æ”¯æŒç›´æ¥é€‰æ‹©å›¾ç‰‡æ–‡ä»¶å¯¼å…¥ï¼ˆæ–°å¢ï¼‰
- âœ… æ”¯æŒ PNG, APNG, GIF, AVIF, JPG, WebP æ ¼å¼
- âœ… æ–‡ä»¶åè‡ªåŠ¨ä½œä¸ºè¡¨æƒ…å¿«æ·ç 
- âœ… æ”¯æŒä¸­æ–‡ç­‰ Unicode å­—ç¬¦
- âœ… å®Œæ•´çš„ä¸­è‹±æ–‡ç•Œé¢
- âœ… ä»£ç é™æ€åˆ†æé€šè¿‡
- âœ… å‘åå…¼å®¹åŸæœ‰åŠŸèƒ½

## ğŸ§ª æµ‹è¯•å»ºè®®

### åŸºæœ¬åŠŸèƒ½æµ‹è¯•
- [ ] ä» .zip æ–‡ä»¶å¯¼å…¥è¡¨æƒ…
- [ ] ä» .tar.gz æ–‡ä»¶å¯¼å…¥è¡¨æƒ…
- [ ] ä» .tgz æ–‡ä»¶å¯¼å…¥è¡¨æƒ…
- [ ] ç›´æ¥é€‰æ‹©å¤šä¸ªå›¾ç‰‡å¯¼å…¥

### æ–‡ä»¶æ ¼å¼æµ‹è¯•ï¼ˆé‡è¦ï¼ï¼‰
- [ ] å¯¼å…¥çº¯ PNG æ ¼å¼è¡¨æƒ…åŒ…
- [ ] å¯¼å…¥çº¯ GIF æ ¼å¼è¡¨æƒ…åŒ…
- [ ] å¯¼å…¥çº¯ JPG æ ¼å¼è¡¨æƒ…åŒ…
- [ ] **å¯¼å…¥æ··åˆæ ¼å¼è¡¨æƒ…åŒ…**ï¼ˆPNG+GIF+JPG+WebPï¼‰â† é‡ç‚¹æµ‹è¯•
- [ ] å¯¼å…¥ APNG åŠ¨ç”»è¡¨æƒ…
- [ ] å¯¼å…¥ AVIF æ ¼å¼è¡¨æƒ…
- [ ] å¯¼å…¥ WebP æ ¼å¼è¡¨æƒ…

### æ··åˆæ ¼å¼åœºæ™¯æµ‹è¯•ï¼ˆçœŸå®ä½¿ç”¨åœºæ™¯ï¼‰
- [ ] å‹ç¼©åŒ…åŒ…å« .png + .jpg + .gif æ–‡ä»¶
- [ ] å‹ç¼©åŒ…åŒ…å«å¤§å°å†™æ··åˆçš„æ‰©å±•åï¼ˆ.PNG, .Jpg, .GIFï¼‰
- [ ] æ–‡ä»¶å¤¹ä¸­åŒæ—¶é€‰æ‹©ä¸åŒæ ¼å¼çš„å›¾ç‰‡

### å‘½åæµ‹è¯•
- [ ] ä¸­æ–‡æ–‡ä»¶åå¯¼å…¥
- [ ] è‹±æ–‡æ–‡ä»¶åå¯¼å…¥
- [ ] æ··åˆå­—ç¬¦æ–‡ä»¶åå¯¼å…¥
- [ ] åŒ…å«ç©ºæ ¼çš„æ–‡ä»¶å
- [ ] åŒ…å«ç‰¹æ®Šå­—ç¬¦çš„æ–‡ä»¶å

### è¾¹ç•Œæµ‹è¯•
- [ ] å¯¼å…¥å¤§é‡è¡¨æƒ…ï¼ˆ50+ï¼‰
- [ ] å¯¼å…¥å¤§æ–‡ä»¶ï¼ˆ>5MBï¼‰
- [ ] æ–‡ä»¶åé‡å¤å¤„ç†
- [ ] å–æ¶ˆå¯¼å…¥æ“ä½œ
- [ ] å‹ç¼©åŒ…ä¸­åŒ…å«éå›¾ç‰‡æ–‡ä»¶ï¼ˆåº”è¢«å¿½ç•¥æˆ–è¿‡æ»¤ï¼‰

## ğŸ‰ æ€»ç»“

è¿™æ¬¡æ›´æ–°ä¸ºè¡¨æƒ…å¯¼å…¥åŠŸèƒ½æä¾›äº†æ›´å¤šçµæ´»æ€§ï¼š
1. **å¤šç§å¯¼å…¥æ–¹å¼** - zipã€tar.gzã€ç›´æ¥æ–‡ä»¶
2. **æ›´å¤šæ ¼å¼æ”¯æŒ** - PNGã€APNGã€GIFã€AVIFã€JPGã€WebP
3. **æ›´å¥½çš„å‘½å** - æ–‡ä»¶åå³å¿«æ·ç ï¼Œæ”¯æŒä¸­æ–‡
4. **æ›´ç®€å•çš„æµç¨‹** - æ— éœ€å‹ç¼©å³å¯å¯¼å…¥

ç°åœ¨ç”¨æˆ·å¯ä»¥æ ¹æ®è‡ªå·±çš„ä¹ æƒ¯å’Œéœ€æ±‚é€‰æ‹©æœ€åˆé€‚çš„å¯¼å…¥æ–¹å¼ï¼
